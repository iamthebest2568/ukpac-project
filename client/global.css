/* figma-style1.css imported locally by each project's layout */
/* figma-style1.css imported locally by each project's layout */
@import "./styles/responsive-utils.css";
@import "./styles/ukpack2-embedded.css";
@import "./styles/ukpack2-tablet.css";
@import "./styles/ukpack2-desktop.css";
@import "./styles/ukpack2-tablet-mock.css";
@import "./styles/ukpack2-skipend-overrides.css";
@import "./styles/minigame-mn1-overrides.css";
@import "./styles/minigame-mn2-overrides.css";
@import "./styles/minigame-mn3-overrides.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /**
   * UK PACK Design System - UX/UI Heuristics Applied
   * Consistent design system enforcing Jakob's Law and visual hierarchy
   */
  :root {
    /* Color System - Strict palette enforcement */
    --color-primary-action: #ffd100; /* Bright yellow - PRIMARY ACTIONS ONLY */
    --color-secondary-action: #6c757d; /* Medium grey - SECONDARY ACTIONS ONLY */
    --color-dark-theme-bg: #0d1b2a; /* Dark navy - GAME SCREENS ONLY */
    --color-white-theme-bg: #000000; /* Black - NARRATIVE SCREENS ONLY */
    --color-success: #10b981; /* Green for completed states */
    --color-warning: #f59e0b; /* Amber for attention states */
    --color-error: #ef4444; /* Red for error states */
    --color-text-primary: #ffffff; /* White for primary text on black background */
    --color-text-secondary: #9ca3af; /* Light grey for secondary text on black background */
    --color-text-inverse: #ffffff; /* White text for dark backgrounds */
    --color-border: #374151; /* Dark grey for borders on black background */
    --color-border-focus: var(
      --color-primary-action
    ); /* Yellow for focus states */

    /* Typography Scale - Strict hierarchy */
    --font-size-h1: 32px; /* Main questions (H1) */
    --font-size-h2: 24px; /* Sub questions (H2) */
    --font-size-body: 16px; /* Body text, labels, buttons */
    --font-size-caption: 14px; /* Small text, help text */
    --font-size-micro: 12px; /* Very small text */

    --font-weight-bold: 700; /* Headers, important text */
    --font-weight-medium: 500; /* Buttons, labels */
    --font-weight-regular: 400; /* Body text */

    --line-height-tight: 1.25; /* Headers */
    --line-height-normal: 1.5; /* Body text */
    --line-height-relaxed: 1.75; /* Long form text */

    /* Spacing System - Consistent vertical rhythm */
    --space-micro: 4px;
    --space-xs: 8px;
    --space-sm: 12px;
    --space-md: 16px; /* Base unit */
    --space-lg: 24px;
    --space-xl: 32px; /* Between sections */
    --space-2xl: 48px; /* Above main questions */
    --space-3xl: 64px; /* Major sections */

    /* Interactive Elements */
    --border-radius-sm: 6px;
    --border-radius-md: 8px;
    --border-radius-lg: 12px;
    --border-radius-full: 999px; /* Buttons only */

    --border-width-thin: 1px;
    --border-width-medium: 2px;
    --border-width-thick: 3px; /* Selection indicators */

    /* Shadows and elevations */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    --shadow-focus: 0 0 0 3px rgba(255, 209, 0, 0.3);

    /* Animation timing */
    --transition-fast: 150ms ease-in-out;
    --transition-normal: 250ms ease-in-out;
    --transition-slow: 350ms ease-in-out;
  }

  /* Global resets and base styles */
  * {
    box-sizing: border-box;
  }

  html,
  body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background-color: #222; /* Neutral dark background for desktop */
    font-family: "Prompt";
  }

  body {
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
    color: var(--color-text-primary);
    margin: 0;
    padding: 0;
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Enhanced Focus Management for Accessibility */
  *:focus {
    outline: 2px solid var(--color-primary-action);
    outline-offset: 2px;
    box-shadow: var(--shadow-focus);
  }

  /* Focus-visible polyfill support */
  .focus-visible {
    outline: 2px solid var(--color-primary-action);
    outline-offset: 2px;
    box-shadow: var(--shadow-focus);
  }

  /* Remove focus from mouse users, keep for keyboard users */
  .js-focus-visible *:focus:not(.focus-visible) {
    outline: none;
    box-shadow: none;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    :root {
      --color-primary-action: #000000;
      --color-text-primary: #000000;
      --color-text-secondary: #333333;
      --color-border: #000000;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* Skeleton shimmer effect for loading placeholders */
  @keyframes skeletonShimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  .skeleton-shimmer {
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.06) 0%,
      rgba(255, 255, 255, 0.14) 50%,
      rgba(255, 255, 255, 0.06) 100%
    );
    background-size: 200% 100%;
    animation: skeletonShimmer 1.2s linear infinite;
  }

  /* Slight pulse fallback */
  .skeleton-pulse {
    @apply animate-pulse;
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    :root {
      --color-text-primary: #f9fafb;
      --color-text-secondary: #d1d5db;
      --color-border: #4b5563;
    }
  }
}

@layer base {
  /* Layout System - Mobile-first responsive container */
  /* Global application container: fluid on mobile, capped at 1080px on large screens */
  /* Global application container: fluid on mobile, capped at 1080px on large screens */
  .app-container {
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
    padding: 0 var(--space-sm);
    min-height: 100vh; /* safe fallback */
    min-height: 100svh; /* prefer the small viewport unit on mobile */
    height: 100vh; /* legacy fallback */
    height: 100svh; /* modern mobile viewport-aware height */
    display: flex; /* layout children vertically */
    flex-direction: column;
    overflow: hidden; /* disable scrolling on container */
    box-sizing: border-box;
  }

  /* Main content area inside the app container should grow to fill vertical space */
  #main-content {
    width: 100%;
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    min-height: 0; /* allow children to shrink properly */
    overflow: hidden;
  }

  /* Ensure the immediate route/content wrapper fills available space and doesn't cause overflow */
  #main-content > * {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Utility for Figma-based canvas components that rely on a 1080x1920 baseline */
  .figma-canvas {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  /* Prevent any horizontal overflow across the app */
  html,
  body,
  #root {
    overflow-x: hidden;
    height: 100%;
  }

  /* Normalize utility classes that assume full viewport height when inside app-container
     Many components use Tailwind's min-h-screen/h-screen which conflict with our full-screen
     app-container. Override them so children size relative to the app container instead. */
  .app-container .min-h-screen {
    min-height: 0 !important;
    height: 100% !important;
  }

  .app-container .h-screen {
    height: 100% !important;
  }

  /* Disable internal scrolling utilities inside the app container to enforce single-scrollless layout */
  .app-container .overflow-y-auto,
  .app-container .overflow-auto,
  .app-container .overflow-scroll {
    overflow: hidden !important;
  }

  /* Ensure any direct full-height children fill available space and can flex properly */
  .app-container > * {
    min-height: 0;
    height: 100%;
  }

  /* Backstop: avoid unexpected body scroll when children exceed container */
  body {
    overflow-y: hidden;
  }

  /* Small mobile devices (320px and below) */
  @media (max-width: 320px) {
    .app-container {
      padding: 0 var(--space-xs);
    }
  }

  /* Large mobile devices (375px and up) */
  @media (min-width: 375px) {
    .app-container {
      padding: 0 var(--space-md);
    }
  }

  /* Tablet and desktop (421px and up) */
  @media (min-width: 421px) {
    .app-container {
      padding: 0 var(--space-lg);
    }
  }

  /* Desktop: remove fixed 1080x1920 phone-frame centered - allow full width */
  @media (min-width: 1081px) {
    .app-container,
    .main-app-container {
      width: 100% !important;
      height: auto !important;
      margin: 0 auto !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      overflow: visible !important;
      display: block !important;
    }

    /* Allow body scrolling on desktop */
    body {
      overflow-y: auto;
    }
  }

  /* Re-enable scrolling for ukpack2 content areas inside app-container */
  .app-container .uk2-scroll {
    overflow: auto !important;
    -webkit-overflow-scrolling: touch;
  }

  /* Full-bleed route override */
  .full-bleed-page .app-container {
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    overflow: visible !important; /* allow children to render full-bleed */
  }

  /* Theme Enforcement */
  .theme-white {
    background-color: #000000;
    color: var(--color-text-primary);
  }

  .theme-dark {
    background-color: var(--color-dark-theme-bg);
    color: var(--color-text-inverse);
  }

  /* Typography System - Mobile-first responsive hierarchy */
  .text-h1 {
    font-size: clamp(24px, 5vw, var(--font-size-h1));
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    margin-top: var(--space-xl);
    margin-bottom: var(--space-lg);
    text-align: center;
  }

  .text-h2 {
    font-size: clamp(20px, 4vw, var(--font-size-h2));
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    margin-top: var(--space-xl);
    margin-bottom: var(--space-lg);
    text-align: center;
  }

  .text-h3 {
    font-size: clamp(18px, 3.5vw, 20px);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    margin-bottom: var(--space-md);
  }

  .text-body {
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
  }

  .text-caption {
    font-size: var(--font-size-caption);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
    color: var(--color-text-secondary);
  }

  .text-micro {
    font-size: var(--font-size-micro);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
    color: var(--color-text-secondary);
  }

  .text-error {
    color: var(--color-error);
  }

  /* Mobile typography optimizations */
  @media (max-width: 375px) {
    .text-h1 {
      margin-top: var(--space-lg);
      margin-bottom: var(--space-md);
    }

    .text-h2 {
      margin-top: var(--space-lg);
      margin-bottom: var(--space-md);
    }
  }

  /* Button System - Mobile-optimized touch targets */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-height: 48px; /* WCAG AA minimum touch target */
    padding: var(--space-md) var(--space-lg);
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-medium);
    border-radius: var(--border-radius-full);
    border: none;
    cursor: pointer;
    transition: all var(--transition-normal);
    text-decoration: none;
    width: 100%;
    position: relative;
    overflow: hidden;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* Remove iOS tap highlight */
  }

  /* Larger touch targets on small screens */
  @media (max-width: 375px) {
    .btn {
      min-height: 52px;
      padding: var(--space-md) var(--space-md);
      font-size: clamp(15px, 4vw, 16px);
    }
  }

  .btn:before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: left var(--transition-slow);
  }

  .btn:hover:before {
    left: 100%;
  }

  /* Primary Button - ONLY for main actions */
  .btn-primary {
    background-color: var(--color-primary-action);
    color: #000000;
    box-shadow: var(--shadow-md);
  }

  .btn-primary:hover:not(:disabled) {
    background-color: #e6bc00;
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg);
  }

  .btn-primary:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: var(--shadow-sm);
  }

  /* Secondary Button - ONLY for alternative actions */
  .btn-secondary {
    background-color: var(--color-secondary-action);
    color: var(--color-text-inverse);
    box-shadow: var(--shadow-md);
  }

  .btn-secondary:hover:not(:disabled) {
    background-color: #5a626b;
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg);
  }

  .btn-secondary:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: var(--shadow-sm);
  }

  /* Disabled state - Enhanced accessibility */
  .btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
    pointer-events: none;
    position: relative;
  }

  .btn:disabled::after {
    content: attr(aria-label);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--border-radius-sm);
    font-size: var(--font-size-micro);
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    z-index: 1000;
    transition: opacity var(--transition-normal);
  }

  .btn:disabled:hover::after {
    opacity: 1;
  }

  /* Enhanced button accessibility */
  .btn[aria-pressed="true"] {
    background-color: var(--color-success);
    border-color: var(--color-success);
  }

  .btn:focus-visible {
    outline: 2px solid var(--color-primary-action);
    outline-offset: 2px;
  }

  /* Black Theme Selection Checkbox - For black background screens */
  .selection-checkbox-white {
    @apply flex items-center p-4 rounded-lg border cursor-pointer transition-all duration-200;
    background-color: #000000;
    border-color: #374151;
    color: var(--color-text-primary);
  }

  .selection-checkbox-white:hover:not(.disabled) {
    border-color: var(--color-primary-action);
    background-color: #1a1a1a;
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  .selection-checkbox-white.selected {
    border-color: var(--color-primary-action);
    background-color: var(--color-primary-action);
    color: #000000;
    box-shadow: var(--shadow-md);
  }

  .selection-checkbox-white.disabled {
    opacity: 0.4;
    cursor: not-allowed;
    background-color: #333333;
    border-color: #555555;
  }

  .selection-checkbox-white .checkbox-icon {
    @apply w-5 h-5 rounded border-2 mr-3 flex items-center justify-center flex-shrink-0;
    border-color: #374151;
    background-color: #000000;
  }

  .selection-checkbox-white.selected .checkbox-icon {
    background-color: var(--color-primary-action);
    border-color: var(--color-primary-action);
  }

  .selection-checkbox-white.disabled .checkbox-icon {
    background-color: #333333;
    border-color: #555555;
  }

  /* Budget Display - Black Theme */
  .budget-display-white {
    @apply p-4 bg-black rounded-lg border border-gray-600 mb-6;
  }

  .budget-display-white .budget-item {
    @apply text-lg font-medium mb-2;
  }

  .budget-display-white .budget-remaining {
    @apply text-lg font-bold;
  }

  .budget-display-white .budget-remaining.positive {
    color: var(--color-warning);
  }

  .budget-display-white .budget-remaining.negative {
    color: var(--color-error);
  }

  /* Polaroid Frame Styles - Mobile responsive */
  .polaroid-frame {
    @apply bg-black p-3 pb-6 shadow-lg;
    width: clamp(160px, 45vw, 200px);
    border-radius: 4px;
    transition: transform 0.3s ease;
    box-sizing: border-box;
  }

  .polaroid-frame:hover {
    transform: scale(1.03) !important;
  }

  .polaroid-image {
    @apply w-full mb-2;
    height: clamp(120px, 30vw, 160px);
    border-radius: 2px;
  }

  .polaroid-caption {
    @apply text-center text-white font-medium;
    font-family: "Prompt";
    font-size: clamp(11px, 2.5vw, 14px);
    margin-top: 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.2;
  }

  /* Mobile polaroid adjustments */
  @media (max-width: 375px) {
    .polaroid-frame {
      @apply p-2 pb-4;
      margin: 0 2px; /* Tighter spacing on small screens */
    }

    .polaroid-frame:hover {
      transform: scale(1.02) !important;
    }
  }

  /* Selection Components - Mobile optimized */
  .selection-checkbox {
    display: flex;
    align-items: center;
    padding: var(--space-md);
    border: var(--border-width-medium) solid #374151;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--transition-normal);
    margin-bottom: var(--space-md);
    background-color: transparent;
    min-height: 48px; /* Touch target accessibility */
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }

  /* Larger touch areas on mobile */
  @media (max-width: 375px) {
    .selection-checkbox {
      min-height: 52px;
      padding: var(--space-sm) var(--space-md);
    }
  }

  .selection-checkbox:hover {
    border-color: #9ca3af;
    background-color: rgba(156, 163, 175, 0.05);
  }

  .selection-checkbox.selected {
    border-color: var(--color-primary-action);
    background-color: rgba(255, 209, 0, 0.1);
  }

  .selection-checkbox.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  .checkbox-icon {
    width: 20px;
    height: 20px;
    border: var(--border-width-medium) solid #9ca3af;
    border-radius: var(--border-radius-sm);
    margin-right: var(--space-md);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all var(--transition-normal);
  }

  .selection-checkbox.selected .checkbox-icon {
    background-color: var(--color-primary-action);
    border-color: var(--color-primary-action);
  }

  .selection-card {
    padding: var(--space-md);
    border: var(--border-width-medium) solid #374151;
    border-radius: var(--border-radius-lg);
    cursor: pointer;
    transition: all var(--transition-normal);
    text-align: center;
    background-color: transparent;
    min-height: 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }

  /* Mobile optimizations for selection cards */
  @media (max-width: 375px) {
    .selection-card {
      padding: var(--space-sm);
      min-height: 88px;
    }
  }

  @media (min-width: 376px) {
    .selection-card {
      padding: var(--space-lg);
      min-height: 120px;
    }
  }

  .selection-card:hover {
    border-color: #9ca3af;
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
  }

  .selection-card.selected {
    border-color: var(--color-primary-action);
    border-width: var(--border-width-thick);
    background-color: rgba(255, 209, 0, 0.1);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .selection-card.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* Input Fields - Mobile optimized */
  .input-field {
    width: 100%;
    padding: var(--space-md);
    border: var(--border-width-medium) solid var(--color-border);
    border-radius: var(--border-radius-md);
    font-size: var(--font-size-body);
    font-family: inherit;
    transition: all var(--transition-normal);
    background-color: transparent;
    min-height: 48px; /* Touch target accessibility */
    box-sizing: border-box;
    -webkit-appearance: none; /* Remove iOS styling */
    resize: vertical; /* Only allow vertical resize on textareas */
  }

  /* Mobile input optimizations */
  @media (max-width: 375px) {
    .input-field {
      font-size: 16px; /* Prevent zoom on iOS */
      padding: var(--space-sm) var(--space-md);
    }
  }

  .input-field:focus {
    border-color: var(--color-border-focus);
    box-shadow: var(--shadow-focus);
  }

  .input-field.border-error {
    border-color: var(--color-error);
  }

  .input-field.border-error:focus {
    border-color: var(--color-error);
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.3);
  }

  .input-field::placeholder {
    color: var(--color-text-secondary);
  }

  /* Dark theme input */
  .theme-dark .input-field {
    border-color: #4b5563;
    color: var(--color-text-inverse);
  }

  .theme-dark .input-field:focus {
    border-color: var(--color-border-focus);
  }

  /* Progress Indicators */
  .progress-container {
    text-align: center;
    margin: var(--space-2xl) 0;
  }

  .progress-dots {
    display: flex;
    justify-content: center;
    gap: var(--space-xs);
    margin-bottom: var(--space-sm);
  }

  .progress-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    transition: all var(--transition-normal);
  }

  .progress-dot.completed {
    background-color: var(--color-success);
    transform: scale(1.1);
  }

  .progress-dot.active {
    background-color: var(--color-primary-action);
    transform: scale(1.25);
    box-shadow: 0 0 8px rgba(255, 209, 0, 0.4);
  }

  .progress-dot.inactive {
    background-color: #9ca3af;
  }

  .theme-dark .progress-dot.inactive {
    background-color: #4b5563;
  }

  /* Status Messages */
  .status-message {
    padding: var(--space-md);
    border-radius: var(--border-radius-md);
    margin: var(--space-lg) 0;
    font-size: var(--font-size-caption);
    text-align: center;
  }

  .status-message.info {
    background-color: #1e3a8a;
    color: #dbeafe;
    border: 1px solid #3b82f6;
  }

  .status-message.warning {
    background-color: #92400e;
    color: #fed7aa;
    border: 1px solid #f59e0b;
  }

  .status-message.error {
    background-color: #7f1d1d;
    color: #fecaca;
    border: 1px solid #ef4444;
  }

  .status-message.success {
    background-color: #14532d;
    color: #bbf7d0;
    border: 1px solid #10b981;
  }

  /* Illustration Panels */
  .illustration-panel {
    border: var(--border-width-medium) solid #ffffff;
    border-radius: var(--border-radius-lg);
    padding: var(--space-lg);
    margin-bottom: var(--space-xl);
    background-color: #000000;
    box-shadow: var(--shadow-sm);
    animation: fadeInUp 0.6s ease-out;
  }

  .theme-dark .illustration-panel {
    border-color: var(--color-text-inverse);
  }

  /* Completion Zone - Clear visual separation */
  .completion-zone {
    margin-top: var(--space-2xl);
    padding-top: var(--space-xl);
    border-top: 1px solid var(--color-border);
  }

  .theme-dark .completion-zone {
    border-top-color: #4b5563;
  }

  /* Utility classes for consistent spacing */
  .section-spacing {
    margin-bottom: var(--space-xl);
  }

  .item-spacing {
    margin-bottom: var(--space-md);
  }

  /* Animation definitions */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in-up {
    animation: fadeInUp var(--transition-slow) ease-out;
  }
}

@layer components {
  /* High-level component patterns */
  .question-section {
    margin-bottom: var(--space-xl);
  }

  .answer-section {
    margin-bottom: var(--space-2xl);
  }

  .context-info {
    padding: var(--space-md);
    background-color: rgba(59, 130, 246, 0.05);
    border-radius: var(--border-radius-md);
    border-left: 4px solid #3b82f6;
    margin-bottom: var(--space-xl);
  }

  /* Selection counter - Visibility of system status */
  .selection-counter {
    text-align: center;
    font-size: var(--font-size-caption);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-lg);
    font-weight: var(--font-weight-medium);
  }

  .theme-dark .selection-counter {
    color: #9ca3af;
  }

  /* Budget display - Enhanced visibility */
  .budget-display {
    background-color: rgba(255, 209, 0, 0.1);
    border: 2px solid var(--color-primary-action);
    border-radius: var(--border-radius-lg);
    padding: var(--space-lg);
    margin-bottom: var(--space-xl);
    text-align: center;
  }

  .budget-item {
    font-size: 18px;
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-sm);
  }

  .budget-remaining {
    font-size: 20px;
    font-weight: var(--font-weight-bold);
  }

  .budget-remaining.negative {
    color: var(--color-error);
  }

  .budget-remaining.positive {
    color: var(--color-success);
  }
}

/* Accessibility and Error Prevention Utilities */
@layer utilities {
  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .sr-only-focusable:focus {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  /* Skip to main content link */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--color-primary-action);
    color: #000000;
    padding: 8px;
    text-decoration: none;
    border-radius: var(--border-radius-sm);
    font-weight: var(--font-weight-medium);
    z-index: 1000;
    transition: top var(--transition-fast);
  }

  .skip-link:focus {
    top: 6px;
  }

  /* High contrast borders for better accessibility */
  .accessible-border {
    border: 2px solid currentColor;
  }

  /* Focus trap utilities */
  .focus-trap-active {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1000;
  }

  /* Announce to screen readers */
  .announce {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  /* Error prevention styles */
  .limit-reached {
    opacity: 0.5;
    pointer-events: none;
    position: relative;
  }

  .limit-reached::after {
    content: "ครบจำนวนที่เลือกแล้ว";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--border-radius-sm);
    font-size: var(--font-size-micro);
    white-space: nowrap;
    opacity: 0;
    transition: opacity var(--transition-normal);
    z-index: 100;
  }

  .limit-reached:hover::after {
    opacity: 1;
  }

  /* Color contrast utilities */
  .high-contrast {
    filter: contrast(200%);
  }

  .low-contrast {
    filter: contrast(50%);
  }

  /* Text size utilities for accessibility */
  .text-large {
    font-size: 1.25em;
    line-height: 1.4;
  }

  .text-extra-large {
    font-size: 1.5em;
    line-height: 1.3;
  }

  /* Interactive element sizing for touch accessibility */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }

  .touch-target-large {
    min-height: 56px;
    min-width: 56px;
  }

  /* Loading state accessibility */
  .loading {
    position: relative;
  }

  .loading::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: inherit;
  }

  .loading::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    font-size: var(--font-size-caption);
    color: var(--color-text-primary);
  }
}

/* Utilities: hide scrollbars for overlay scrollers */
.no-scrollbar {
  -ms-overflow-style: none; /* IE/Edge */
  scrollbar-width: none; /* Firefox */
}
.no-scrollbar::-webkit-scrollbar {
  display: none; /* Safari and Chrome */
}
